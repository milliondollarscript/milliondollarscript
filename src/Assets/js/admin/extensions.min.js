!function(e){"use strict";const n={init:function(){this.bindEvents(),this.initTabs()},bindEvents:function(){e(".nav-tab").on("click",this.handleTabClick),e(document).on("click",".install-extension",this.handleInstallExtension),e(document).on("click",".activate-extension",this.handleActivateExtension),e(document).on("click",".deactivate-extension",this.handleDeactivateExtension),e(document).on("click",".update-extension",this.handleUpdateExtension),e("#mds-check-updates-btn").on("click",this.handleCheckUpdates)},initTabs:function(){const n=window.location.hash;n&&e(n+"-extensions").length?this.showTab(n.replace("#","")):this.showTab("available")},handleTabClick:function(t){t.preventDefault();const s=e(this).attr("href").replace("#","");n.showTab(s),history.pushState&&history.pushState(null,null,"#"+s)},showTab:function(n){e(".nav-tab").removeClass("nav-tab-active"),e('.nav-tab[href="#'+n+'"]').addClass("nav-tab-active"),e(".tab-content").removeClass("active"),e("#"+n+"-extensions").addClass("active")},handleInstallExtension:function(t){t.preventDefault();const s=e(this),i=s.data("extension-id"),o=s.data("extension-name"),a=1===s.data("is-premium");confirm(mdsExtensions.strings.confirm_install)&&(n.setButtonLoading(s,mdsExtensions.strings.installing),e.ajax({url:mdsExtensions.ajaxurl,type:"POST",data:{action:"mds_extensions_install",nonce:mdsExtensions.nonce,extension_id:i,extension_name:o,is_premium:a?"1":""},success:function(e){e.success?(n.showNotice(e.data.message||mdsExtensions.strings.extension_installed,"success"),n.refreshExtensions()):n.showNotice(e.data.message||"Installation failed","error")},error:function(){n.showNotice("Installation failed","error")},complete:function(){n.setButtonLoading(s,!1)}}))},handleActivateExtension:function(t){t.preventDefault();const s=e(this),i=s.data("extension-file");n.setButtonLoading(s,mdsExtensions.strings.activating),e.ajax({url:mdsExtensions.ajaxurl,type:"POST",data:{action:"mds_extensions_activate",nonce:mdsExtensions.nonce,extension_file:i},success:function(e){e.success?(n.showNotice(e.data.message||mdsExtensions.strings.extension_activated,"success"),n.refreshInstalledExtensions()):n.showNotice(e.data.message||"Activation failed","error")},error:function(){n.showNotice("Activation failed","error")},complete:function(){n.setButtonLoading(s,!1)}})},handleDeactivateExtension:function(t){t.preventDefault();const s=e(this),i=s.data("extension-file");n.setButtonLoading(s,mdsExtensions.strings.deactivating),e.ajax({url:mdsExtensions.ajaxurl,type:"POST",data:{action:"mds_extensions_deactivate",nonce:mdsExtensions.nonce,extension_file:i},success:function(e){e.success?(n.showNotice(e.data.message||mdsExtensions.strings.extension_deactivated,"success"),n.refreshInstalledExtensions()):n.showNotice(e.data.message||"Deactivation failed","error")},error:function(){n.showNotice("Deactivation failed","error")},complete:function(){n.setButtonLoading(s,!1)}})},handleUpdateExtension:function(t){t.preventDefault();const s=e(this),i=s.data("extension-id"),o=s.data("extension-name");confirm(mdsExtensions.strings.confirm_update)&&(n.setButtonLoading(s,mdsExtensions.strings.updating),e.ajax({url:mdsExtensions.ajaxurl,type:"POST",data:{action:"mds_extensions_update",nonce:mdsExtensions.nonce,extension_id:i,extension_name:o},success:function(e){e.success?(n.showNotice(e.data.message||mdsExtensions.strings.extension_updated,"success"),n.refreshExtensions()):n.showNotice(e.data.message||"Update failed","error")},error:function(){n.showNotice("Update failed","error")},complete:function(){n.setButtonLoading(s,!1)}}))},handleCheckUpdates:function(t){t.preventDefault();const s=e(this);n.setButtonLoading(s,mdsExtensions.strings.checking_updates),e.ajax({url:mdsExtensions.ajaxurl,type:"POST",data:{action:"mds_extensions_check_updates",nonce:mdsExtensions.nonce},success:function(e){e.success?(n.showNotice(e.data.message,"success"),e.data.updates_available>0&&n.refreshExtensions()):n.showNotice(e.data.message||"Check failed","error")},error:function(){n.showNotice("Check for updates failed","error")},complete:function(){n.setButtonLoading(s,!1)}})},refreshExtensions:function(){e.ajax({url:mdsExtensions.ajaxurl,type:"POST",data:{action:"mds_extensions_refresh",nonce:mdsExtensions.nonce},success:function(e){e.success&&window.location.reload()}})},refreshInstalledExtensions:function(){window.location.reload()},setButtonLoading:function(e,n){n?(e.data("original-text",e.text()),e.text(n),e.prop("disabled",!0),e.closest(".extension-card").addClass("loading")):(e.text(e.data("original-text")||e.text()),e.prop("disabled",!1),e.closest(".extension-card").removeClass("loading"))},showNotice:function(n,t){const s=e('<div class="notice notice-'+(t=t||"info")+' is-dismissible"><p>'+n+"</p></div>");e("#mds-extensions-notices").empty().append(s),"success"===t&&setTimeout((function(){s.fadeOut()}),5e3),e("html, body").animate({scrollTop:e(".wrap").offset().top-50},300)}};e(document).ready((function(){n.init()}))}(jQuery);