jQuery(document).ready(function(d){function r(e,n,t=!0){let s="error"===e?"notice-error":"notice-success";n=`
            <div class="notice ${s} is-dismissible mds-enhanced-notice" style="display: none;">
                <p><span class="mds-notice-icon">${"error"===e?"‚ùå":"‚úÖ"}</span> ${n}</p>
                <button type="button" class="notice-dismiss">
                    <span class="screen-reader-text">Dismiss this notice.</span>
                </button>
            </div>
        `;d(".notice."+s).remove(),d(".mds-extensions-header, .wrap > h1").first().after(n),d(".notice."+s).slideDown(300),t&&"success"===e&&setTimeout(()=>{d(".notice."+s).slideUp(300,function(){d(this).remove()})},5e3),d(document).off("click",".notice-dismiss").on("click",".notice-dismiss",function(){d(this).closest(".notice").slideUp(300,function(){d(this).remove()})})}function c(e,n){e.data("original-text",e.html()),e.prop("disabled",!0).html('<span class="mds-spinner"></span> '+n).addClass("mds-btn-loading")}function l(e,n=null){n=n||e.data("original-text");e.prop("disabled",!1).html(n).removeClass("mds-btn-loading")}d(document).on("click",".mds-check-updates",function(e){e.preventDefault();let o=d(this),i=o.closest("tr");var e=i.data("extension-id"),n=i.data("version"),t=i.data("plugin-file");c(o,"Checking..."),d.ajax({url:MDS_EXTENSIONS_DATA.ajax_url,type:"POST",data:{action:"mds_check_extension_updates",nonce:MDS_EXTENSIONS_DATA.nonce,extension_id:e,current_version:n,plugin_file:t},dataType:"json",success:function(e){var n,t,s,a;e.success?(n=e.data,t=i,s=t.find(".mds-update-cell"),a=t.find(".mds-check-updates"),n.update_available?(n=`
				<div class="mds-update-available">
					<p><strong>üöÄ Version ${n.latest_version} available!</strong></p>
					${n.changelog?`<div class="mds-changelog"><strong>What's new:</strong><br>${n.changelog}</div>`:""}
					<button class="button button-primary mds-install-update"
							data-download-url="${n.download_url}"
							data-extension-slug="${n.extension_slug}"
							data-extension-id="${n.extension_id||""}">
						<span class="mds-btn-icon">‚¨ÜÔ∏è</span> Update Now
					</button>
				</div>
			`,s.html(n),l(a,"Check Again")):(s.html('<span class="mds-no-updates">‚úÖ You have the latest version.</span>'),l(a)),t.trigger("mds-update-checked")):(r("error",e.data.message||"Failed to check for updates."),l(o))},error:function(e,n,t){console.error("Error checking for updates:",t),r("error","An error occurred while checking for updates."),l(o)}})}),d(document).on("click",".mds-install-update",function(e){e.preventDefault();let s=d(this);var e=s.data("extension-id"),n=s.data("extension-slug"),t=s.data("download-url");confirm("üöÄ Ready to update? This will enhance your extension with the latest features and improvements!")&&(c(s,"Updating..."),d.ajax({url:MDS_EXTENSIONS_DATA.ajax_url,type:"POST",data:{action:"mds_install_extension_update",nonce:MDS_EXTENSIONS_DATA.nonce,extension_id:e,extension_slug:n,download_url:t},dataType:"json",success:function(e){e.success?(r("success","üéâ "+(e.data.message||"Update installed successfully!")),e.data.reload&&setTimeout(()=>window.location.reload(),2e3)):(r("error",e.data.message||"Failed to install update."),l(s))},error:function(e,n,t){console.error("Error installing update:",t),r("error","An error occurred while installing the update."),l(s)}}))}),d(document).on("click",".mds-install-extension",function(e){e.preventDefault();let s=d(this);var e=s.data("extension-id"),n=s.data("extension-slug");confirm(`üöÄ Install this extension and start boosting your results today? 

This extension is trusted by thousands of users worldwide! 

‚úÖ Free installation 
‚ö° Instant activation 
üìà Proven results`)&&(c(s,"Installing..."),d.ajax({url:MDS_EXTENSIONS_DATA.ajax_url,type:"POST",data:{action:"mds_install_extension",nonce:MDS_EXTENSIONS_DATA.nonce,extension_id:e,extension_slug:n},dataType:"json",success:function(e){e.success?(r("success","üéâ Awesome! Extension installed and ready to boost your results!"),s.removeClass("mds-btn-primary").addClass("mds-btn-active").html('<span class="mds-btn-icon">‚úì</span> Installed'),e.data.reload&&setTimeout(()=>window.location.reload(),2e3)):(r("error",e.data.message||"Failed to install extension."),l(s))},error:function(e,n,t){console.error("Error installing extension:",t),r("error","An error occurred while installing the extension."),l(s)}}))}),d(document).on("click",".mds-activate-extension",function(e){e.preventDefault();let s=d(this);var e=s.data("extension-slug"),n=s.data("nonce");confirm("‚ö° Activate this extension and start using its powerful features?")&&(c(s,"Activating..."),d.ajax({url:MDS_EXTENSIONS_DATA.ajax_url,type:"POST",data:{action:"mds_activate_extension",nonce:n,extension_slug:e},dataType:"json",success:function(e){e.success?(r("success","üéâ Extension is now active and ready to use!"),s.removeClass("mds-btn-secondary mds-activate-extension").addClass("mds-btn-active").html('<span class="mds-btn-icon">‚úì</span> Active').prop("disabled",!0),!1!==e.data.reload&&setTimeout(()=>window.location.reload(),2e3)):(r("error",e.data.message||"Failed to activate extension."),l(s))},error:function(e,n,t){console.error("Error activating extension:",t),r("error","An error occurred while activating the extension."),l(s)}}))}),d(document).on("click",".mds-check-all-updates",function(e){e.preventDefault();let n=d(this),t=d("tr[data-extension-id]"),s=0,a=!1;function o(){s>=t.length&&(l(n),a?r("success","üîÑ Update check complete! Some extensions have updates available."):r("success","‚úÖ All extensions are up to date!"))}c(n,"Checking All..."),t.each(function(){let e=d(this);var n=e.find(".mds-check-updates");n.prop("disabled")?(s++,o()):(n.trigger("click"),e.off("mds-update-checked").on("mds-update-checked",function(){s++,e.find(".mds-update-available").length&&(a=!0),o()}))})}),console.log("üöÄ MDS Extensions enhanced interface loaded successfully!")}),jQuery(document).ready(function(e){e("head").append(`
		<style>
		.mds-enhanced-notice {
			border-left: 4px solid #1a73e8;
			background: linear-gradient(90deg, #e8f0fe 0%, #ffffff 100%);
		}
		
		.mds-notice-icon {
			font-size: 1.2em;
			margin-right: 8px;
		}
		
		.mds-btn-loading {
			position: relative;
			color: transparent !important;
		}
		
		.mds-spinner {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			width: 16px;
			height: 16px;
			border: 2px solid #ffffff;
			border-top: 2px solid transparent;
			border-radius: 50%;
			animation: spin 1s linear infinite;
		}
		
		.mds-changelog {
			background: #f8f9fa;
			border-left: 3px solid #1a73e8;
			padding: 8px 12px;
			margin: 8px 0;
			border-radius: 4px;
			font-size: 0.9em;
		}
		
		.mds-no-updates {
			color: #2e7d2e;
			font-weight: 500;
		}
		</style>
	`)});