!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,i){return void 0===i&&(i="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(i),i}:e(jQuery)}((function(e){"use strict";e.fn.imageScale=function(i){return this.each((function(){var s=this,a=e(this),n=a.data("imageScale"),r="IMG"===this.tagName?a:a.find("img");if(n)if("string"==typeof i)n[i]();else if("object"==typeof i){var o=i.method||"scale";n[o](!1,i)}else n.scale();else{var h=r[0].complete,l=e.extend({},e.fn.imageScale.defaults,"object"==typeof i&&i),c=function(){a.data("imageScale",n=new t(s,l)),n.scale(!0,l)};h?c.apply(a[0]):r.on("load",c).attr("src",r.attr("src"))}}))},e.fn.imageScale.defaults={scale:"best-fill",align:"center",parent:null,hideParentOverflow:!0,fadeInDuration:0,rescaleOnResize:!1,didScale:function(e,t){},logLevel:0};var t=function(t,i){var s=this;s.options=i,s.element=t;var a=s.$element=e(t),n=s.$img="IMG"===t.tagName?a:a.find("img"),r=s.img=n[0];s.src=n.attr("src"),s.imgWidth=r.naturalWidth||r.width,s.imgHeight=r.naturalHeight||r.height;var o=s.$parent=i.parent?i.parent:e(a.parent()[0]);s.parent=o[0],"static"===o.css("position")&&o.css("position","relative"),i.rescaleOnResize&&e(window).on("resize",(function(e){s.scheduleScale()}))};e.fn.imageScale.Constructor=t,t.prototype={NONE:"none",FILL:"fill",BEST_FILL:"best-fill",BEST_FIT:"best-fit",BEST_FIT_DOWN_ONLY:"best-fit-down",ALIGN_LEFT:"left",ALIGN_RIGHT:"right",ALIGN_CENTER:"center",ALIGN_TOP:"top",ALIGN_BOTTOM:"bottom",ALIGN_TOP_LEFT:"top-left",ALIGN_TOP_RIGHT:"top-right",ALIGN_BOTTOM_LEFT:"bottom-left",ALIGN_BOTTOM_RIGHT:"bottom-right",constructor:t,element:null,options:null,scale:function(e,t){if(!this._isDestroyed&&!1!==this._canScale){var i=this,s=this.options,a=this.$parent,n=this.element,r=this.$element,o=(this.img,this.$img);if(e)s.hideParentOverflow&&a.css({overflow:"hidden"});else if(this.src!==o.attr("src"))return this.destroy(),r.data("imageScale",null),void r.imageScale(s);if(this._didScheduleScale=!1,!s.rescaleOnResize||t||this._needUpdate(this.parent)){var h=(t=t||{}).transition;h&&(this._canScale=!1,r.css("transition","all "+h+"ms"),setTimeout((function(){i._canScale=null,r.css("transition","null")}),h));var l=t.destWidth?t.destWidth:a.outerWidth(),c=t.destHeight?t.destHeight:a.outerHeight(),d=l-(t.destWidth?t.destWidth:a.innerWidth()),u=c-(t.destHeight?t.destHeight:a.innerHeight()),f=r.attr("data-scale"),g=r.attr("data-align"),_=f||s.scale,m=g||s.align,T=s.fadeInDuration;if(_){this._cacheDestWidth===l&&this._cacheDestHeight===c&&s.logLevel>2&&console.log("imageScale - DEBUG NOTICE: The parent size hasn't changed: dest width: '"+l+"' - dest height: '"+c+"'.",n);var p=this.imgWidth,I=this.imgHeight;if(l&&c&&p&&I){this._cacheDestWidth=l,this._cacheDestHeight=c;var L=this._innerFrameForSize(_,m,p,I,l,c);d&&(L.x-=d/2),u&&(L.y-=u/2),r.css({position:"absolute",top:Math.ceil(L.y)+"px",left:Math.ceil(L.x)+"px",width:L.width+"px",height:L.height+"px","max-width":"none"}),e&&T&&(r.css({display:"none"}),r.fadeIn(T)),s.didScale.call(this,e,t)}else s.logLevel>0&&console.error("imageScale - DEBUG ERROR: The dimensions are incorrect: source width: '"+p+"' - source height: '"+I+"' - dest width: '"+l+"' - dest height: '"+c+"'.",n)}else s.logLevel>2&&console.log("imageScale - DEBUG NOTICE: The scale property is null.",n)}}},destroy:function(){this._isDestroyed=!0,this.$element.removeData("imageScale")},_innerFrameForSize:function(e,t,i,s,a,n){var r,o,h;if(h={x:0,y:0,width:a,height:n},e===this.FILL)return h;switch(r=a/i,o=n/s,e){case this.BEST_FIT_DOWN_ONLY:e!==this.BEST_FIT_DOWN_ONLY&&this.options.logLevel>1&&console.warn("imageScale - DEBUG WARNING: The scale '"+e+"' was not understood."),e=i>a||s>n?r<o?r:o:1;break;case this.BEST_FIT:e=r<o?r:o;break;case this.NONE:e=1;break;default:e=r>o?r:o}switch(i*=e,s*=e,h.width=Math.round(i),h.height=Math.round(s),t){case this.ALIGN_LEFT:h.x=0,h.y=n/2-s/2;break;case this.ALIGN_RIGHT:h.x=a-i,h.y=n/2-s/2;break;case this.ALIGN_TOP:h.x=a/2-i/2,h.y=0;break;case this.ALIGN_BOTTOM:h.x=a/2-i/2,h.y=n-s;break;case this.ALIGN_TOP_LEFT:h.x=0,h.y=0;break;case this.ALIGN_TOP_RIGHT:h.x=a-i,h.y=0;break;case this.ALIGN_BOTTOM_LEFT:h.x=0,h.y=n-s;break;case this.ALIGN_BOTTOM_RIGHT:h.x=a-i,h.y=n-s;break;default:t!==this.ALIGN_CENTER&&this.options.logLevel>1&&console.warn("imageScale - DEBUG WARNING: The align '"+t+"' was not understood."),h.x=a/2-i/2,h.y=n/2-s/2}return h},_needUpdate:function(e){var t=e.clientHeight+" "+e.clientWidth;return this._lastParentSize!==t&&(this._lastParentSize=t,!0)},scheduleScale:function(){if(!this._didScheduleScale)if(window.requestAnimationFrame){var e=this;this._didScheduleScale=!0,requestAnimationFrame((function(){setTimeout((function(){e.scale()}),0)}))}else this.scale()}}}));